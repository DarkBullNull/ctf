mystery string

* md5sum

    1011cafbd736cdf2ae90964613c911fe


* disassemble:

    1023 ; size_t n

    void *memset(void *s, int c, size_t n)


    6 ; HMODULE hModule
    "rc.rc" ; LPCSTR lpName
    0 ; LPCSTR lpType

    HRSRC FindResourceA(HMODULE hModule, LPCSTR lpName, LPCSTR lpType)


    1023 ; HINSTANCE hInstance
    0 ; UINT uID
    0 ; int cchBufferMax

    1 << 8 = 256
    1 << 4 = 16
    256 | 16 = 272
    mov dword [lpBuffer], eax

    lpBuffer = 272

    int LoadStringA(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax)


* hexedit:

    offset where the flags start
    00002470


* r2 searching for '{' in the binary

    /i {

    locations in binary

    0x004054d1 hit16_0 .v@d{\.
    0x0040567a hit8_1 .2FLAG{WHATSOEV.
    ...
    0x0040fae4 hit8_512 .HE}$FLAG{MICROSOF.


    hit 0 is not a flag,
    valid flags start at hit8_1
    want the flag #272 from offset 0
    so then from offset 1 is flag # 273

    0x0040aefa


* flag

    FLAG{RESOURCES-ARE-POPULAR-FOR-MALWARE}
