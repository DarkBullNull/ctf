Longbottom's Locker

Break into Longbottom's vault and steal his secrets.

Zip Password: hackthebox sha256: 5951f11e77b70c6a2e7130ee638bdec53e789df6a95de6782a66fbf32b841f94

----------------------------------------


index.html has alot of crypto stuff, and the function at the bottom to get the user input.
however this is probably not the way to go about this.


<script>
    document.getElementById('neville-locker-form').addEventListener('submit', function(e) {
        e.preventDefault();

        var passphrase = document.getElementById('passwd').value,
            encryptedMsg = '4cce4470203e10b395ab1787a22553a5b2503d42a965da813676d929cc16f76cU2FsdGVkX19FvUyhqWoQKHXNLBL64g8acK4UQoP6XZQ/n4MRL3rgQj8TJ/3r8Awtxte2V9s+RLfQHJOHGwYtctqRa/H2BetmxjwGG+LYKUWC8Z6WBoYbecwtATCOuwewnp+VKBzsWLme+3BZyRgKEA==',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            alert('Bad passphrase!');
            return;
        }

        var plainHTML = CryptoJS.AES.decrypt(encryptedHTML, passphrase).toString(CryptoJS.enc.Utf8);

        document.write(plainHTML);
        document.close();
    });
</script>


encrypted base64 string

4cce4470203e10b395ab1787a22553a5b2503d42a965da813676d929cc16f76cU2FsdGVkX19FvUyhqWoQKHXNLBL64g8acK4UQoP6XZQ/n4MRL3rgQj8TJ/3r8Awtxte2V9s+RLfQHJOHGwYtctqRa/H2BetmxjwGG+LYKUWC8Z6WBoYbecwtATCOuwewnp+VKBzsWLme+3BZyRgKEA==

ehmac = 4cce4470203e10b395ab1787a22553a5b2503d42a965da813676d929cc16f76
ehtml = cU2FsdGVkX19FvUyhqWoQKHXNLBL64g8acK4UQoP6XZQ/n4MRL3rgQj8TJ/3r8Awtxte2V9s+RLfQHJOHGwYtctqRa/H2BetmxjwGG+LYKUWC8Z6WBoYbecwtATCOuwewnp+VKBzsWLme+3BZyRgKEA==


----------

try extracting the internal contents of the jpeg file

binwalk -e socute.jpg

this produces a file donotshare

this is in pickled format

(lp1
(lp2
(S' '
I163
tp3
aa(lp4
(S' '
I1
tp5
a(S'.'
I1
tp6
a(S'd'
I1
tp7
a(S'8'
I4
tp8
a(S'b'
I1
tp9
a(S'.'
........
.....
...
..
.

unpickled data looks bad to read.
after decode need to pretty print

[(' ', 163)]

[(' ', 1), ('.', 1), ('d', 1), ('8', 4), ('b', 1), ('.', 1), (' ', 12), ('d', 1), ('8', 3), (' ', 7), ('8', 3), (' ', 2), ('.', 1), ('d', 1), ('8', 4), ('b', 1), ('.', 1), (' ', 22), ('d', 1), ('8', 4), (' ', 2), ('8', 3), ('b', 1), (' ', 4), ('8', 3), (' ', 8), ('8', 7), ('b', 1), ('.', 1), (' ', 3), ('.', 1), ('d', 1), ('8', 4), ('b', 1), ('.', 1), (' ', 2), ('8', 9), (' ', 2), ('8', 9), (' ', 2), ('8', 3), (' ', 5), ('8', 3), (' ', 15)]

[('d', 1), ('8', 2), ('P', 1), (' ', 2), ('Y', 1), ('8', 2), ('b', 1), (' ', 10), ('d', 1), ('8', 4), (' ', 7), ('8', 3), (' ', 1), ('d', 1), ('8', 2), ('P', 1), (' ', 2), ('Y', 1), ('8', 2), ('b', 1), (' ', 20), ('d', 1), ('8', 1), ('P', 1), ('8', 3), (' ', 2), ('8', 4), ('b', 1), (' ', 3), ('8', 3), (' ', 8), ('8', 3), (' ', 3), ('Y', 1), ('8', 2), ('b', 1), (' ', 1), ('d', 1), ('8', 2), ('P', 1), (' ', 2), ('Y', 1), ('8', 2), ('b', 1), (' ', 1), ('8', 3), (' ', 8), ('8', 3), (' ', 8), ('8', 3), (' ', 5), ('8', 3), (' ', 15)]

[('8', 3), (' ', 4), ('8', 3), (' ', 12), ('8', 3), (' ', 7), ('8', 3), (' ', 1), ('8', 3), (' ', 4), ('8', 3), (' ', 19), ('d', 1), ('8', 1), ('P', 1), (' ', 1), ('8', 3), (' ', 2), ('8', 5), ('b', 1), (' ', 2), ('8', 3), (' ', 8), ('8', 3), (' ', 4), ('8', 3), (' ', 1), ('8', 3), (' ', 4), ('8', 3), (' ', 1), ('8', 3), (' ', 8), ('8', 3), (' ', 8), ('8', 3), (' ', 5), ('8', 3), (' ', 15)]

[('8', 3), (' ', 8), ('8', 3), (' ', 2), ('8', 3), (' ', 3), ('8', 3), (' ', 3), ('.', 1), ('d', 1), ('8', 5), (' ', 1), ('8', 3), (' ', 4), ('8', 3), (' ', 8), ('8', 3), (' ', 2), ('8', 3), (' ', 2), ('d', 1), ('8', 1), ('P', 1), (' ', 2), ('8', 3), (' ', 2), ('8', 3), ('Y', 1), ('8', 2), ('b', 1), (' ', 1), ('8', 3), (' ', 8), ('8', 3), (' ', 3), ('d', 1), ('8', 2), ('P', 1), (' ', 1), ('8', 3), (' ', 4), ('8', 3), (' ', 1), ('8', 7), ('b', 1), ('.', 1), (' ', 2), ('8', 7), ('b', 1), ('.', 1), (' ', 2), ('8', 3), (' ', 5), ('8', 3), (' ', 1), ('8', 5), ('b', 1), ('.', 1), ('d', 1), ('8', 2), ('b', 1), ('.', 1), (' ', 2)]

[('8', 3), (' ', 2), ('8', 5), (' ', 1), ('8', 3), (' ', 2), ('8', 3), (' ', 3), ('8', 3), (' ', 2), ('d', 1), ('8', 2), ('"', 1), (' ', 1), ('8', 3), (' ', 1), ('8', 3), (' ', 4), ('8', 3), (' ', 8), ('8', 3), (' ', 2), ('8', 3), (' ', 1), ('d', 1), ('8', 2), (' ', 3), ('8', 3), (' ', 2), ('8', 3), (' ', 1), ('Y', 1), ('8', 2), ('b', 1), ('8', 3), (' ', 8), ('8', 7), ('P', 1), ('"', 1), (' ', 2), ('8', 3), (' ', 4), ('8', 3), (' ', 6), ('"', 1), ('Y', 1), ('8', 2), ('b', 1), (' ', 6), ('"', 1), ('Y', 1), ('8', 2), ('b', 1), (' ', 1), ('8', 3), (' ', 5), ('8', 3), (' ', 1), ('8', 3), (' ', 1), ('"', 1), ('8', 3), (' ', 1), ('"', 1), ('8', 2), ('b', 1), (' ', 1)]

[('8', 3), (' ', 4), ('8', 3), (' ', 1), ('8', 3), (' ', 2), ('8', 3), (' ', 3), ('8', 3), (' ', 2), ('8', 3), (' ', 2), ('8', 3), (' ', 1), ('8', 3), (' ', 4), ('8', 3), (' ', 1), ('8', 6), (' ', 1), ('Y', 1), ('8', 2), (' ', 2), ('8', 2), ('P', 1), (' ', 1), ('8', 10), (' ', 1), ('8', 3), (' ', 2), ('Y', 1), ('8', 5), (' ', 1), ('8', 6), (' ', 1), ('8', 3), (' ', 1), ('T', 1), ('8', 2), ('b', 1), (' ', 3), ('8', 3), (' ', 4), ('8', 3), (' ', 8), ('8', 3), (' ', 8), ('8', 3), (' ', 1), ('8', 3), (' ', 5), ('8', 3), (' ', 1), ('8', 3), (' ', 2), ('8', 3), (' ', 2), ('8', 3), (' ', 1)]

[('Y', 1), ('8', 2), ('b', 1), (' ', 2), ('d', 1), ('8', 2), ('P', 1), (' ', 1), ('Y', 1), ('8', 2), ('b', 1), (' ', 1), ('8', 3), (' ', 3), ('8', 3), (' ', 2), ('Y', 1), ('8', 2), ('b', 1), (' ', 1), ('8', 3), (' ', 1), ('Y', 1), ('8', 2), ('b', 1), (' ', 2), ('d', 1), ('8', 2), ('P', 1), (' ', 9), ('Y', 1), ('8', 1), ('b', 1), ('d', 1), ('8', 1), ('P', 1), (' ', 8), ('8', 3), (' ', 2), ('8', 3), (' ', 3), ('Y', 1), ('8', 4), (' ', 8), ('8', 3), (' ', 2), ('T', 1), ('8', 2), ('b', 1), (' ', 2), ('Y', 1), ('8', 2), ('b', 1), (' ', 2), ('d', 1), ('8', 2), ('P', 1), (' ', 1), ('Y', 1), ('8', 2), ('b', 1), (' ', 2), ('d', 1), ('8', 2), ('P', 1), (' ', 1), ('Y', 1), ('8', 2), ('b', 1), (' ', 2), ('d', 1), ('8', 2), ('P', 1), (' ', 1), ('Y', 1), ('8', 2), ('b', 1), ('.', 1), (' ', 1), ('.', 1), ('d', 1), ('8', 2), ('P', 1), (' ', 1), ('8', 3), (' ', 2), ('8', 3), (' ', 2), ('8', 3), (' ', 1)]

[(' ', 1), ('"', 1), ('Y', 1), ('8', 4), ('P', 1), ('8', 2), (' ', 2), ('"', 1), ('Y', 1), ('8', 5), (' ', 1), ('8', 7), (' ', 1), ('"', 1), ('Y', 1), ('8', 5), (' ', 2), ('"', 1), ('Y', 1), ('8', 4), ('P', 1), ('"', 1), (' ', 11), ('Y', 1), ('8', 2), ('P', 1), (' ', 9), ('8', 3), (' ', 2), ('8', 3), (' ', 4), ('Y', 1), ('8', 3), (' ', 8), ('8', 3), (' ', 3), ('T', 1), ('8', 2), ('b', 1), (' ', 2), ('"', 1), ('Y', 1), ('8', 4), ('P', 1), ('"', 1), (' ', 3), ('"', 1), ('Y', 1), ('8', 4), ('P', 1), ('"', 1), (' ', 3), ('"', 1), ('Y', 1), ('8', 4), ('P', 1), ('"', 1), (' ', 3), ('"', 1), ('Y', 1), ('8', 5), ('P', 1), ('"', 1), (' ', 2), ('8', 3), (' ', 2), ('8', 3), (' ', 2), ('8', 3), (' ', 1)]

[(' ', 163)]



 .d8888b.            d888       888  .d8888b.                      d8888  888b    888        8888888b.   .d8888b.  888888888  888888888  888     888
d88P  Y88b          d8888       888 d88P  Y88b                    d8P888  8888b   888        888   Y88b d88P  Y88b 888        888        888     888
888    888            888       888 888    888                   d8P 888  88888b  888        888    888 888    888 888        888        888     888
888        888  888   888   .d88888 888    888        888  888  d8P  888  888Y88b 888        888   d88P 888    888 8888888b.  8888888b.  888     888 88888b.d88b.
888  88888 888  888   888  d88" 888 888    888        888  888 d88   888  888 Y88b888        8888888P"  888    888      "Y88b      "Y88b 888     888 888 "888 "88b
888    888 888  888   888  888  888 888    888 888888 Y88  88P 8888888888 888  Y88888 888888 888 T88b   888    888        888        888 888     888 888  888  888
Y88b  d88P Y88b 888   888  Y88b 888 Y88b  d88P         Y8bd8P        888  888   Y8888        888  T88b  Y88b  d88P Y88b  d88P Y88b  d88P Y88b. .d88P 888  888  888
 "Y8888P88  "Y88888 8888888 "Y88888  "Y8888P"           Y88P         888  888    Y888        888   T88b  "Y8888P"   "Y8888P"   "Y8888P"   "Y88888P"  888  888  888



Gu1d0-v4N-R055Um



this script will unpickle and print

#!/usr/bin/python3
import pickle

with open('donotshare', 'rb') as f:
    o = pickle.load(f)

outstr = ''
for line in o:
    for char,n in line:
        outstr += char*n
    outstr += '\n'
print(outstr)